import*as Client from"./client.js";export function ProcessMessage(e){const t=e.slice(0,1),n=e.slice(1),r=mesutils.Parse(n);switch(t){case"S":Client.EnterLobby(parseInt(r.get("C")));break;case"N":Client.InvalidJoinCode();break;case"L":Client.OpponentLostConnection();break;case"R":Client.OpponentReconnected(r.get("N"));break;case"G":OnlineSessionStart("B"===r.get("S")?"bottom":"top",parseInt(r.get("T")),r.get("O"),r.get("F"),r.get("C"));break;case"!":switch(r.get("A")){case"set":Client.PresentationConnector.ServerToClientCallbacks.SetOccupation.call(Client.PresentationConnector.Callers.Client,r.get("S"),parseInt(r.get("I")),parseInt(r.get("O")));break;case"transfer":Client.PresentationConnector.ServerToClientCallbacks.AddTransfer.call(Client.PresentationConnector.Callers.Client,parseInt(r.get("C")),r.get("F"),parseInt(r.get("O")),r.get("T"),parseInt(r.get("D")));break;case"turn":Client.PresentationConnector.ServerToClientCallbacks.SetTurn.call(Client.PresentationConnector.Callers.Client,r.get("T"));const e=game.TopOccFromFieldString(r.get("F")),t=game.BottomOccFromFieldString(r.get("F"));for(let n=0;n<16;n++)Client.PresentationConnector.ServerToClientCallbacks.SetOccupation.call(Client.PresentationConnector.Callers.Client,"top",n,e[n]),Client.PresentationConnector.ServerToClientCallbacks.SetOccupation.call(Client.PresentationConnector.Callers.Client,"bottom",n,t[n]);break;case"reverse":Client.PresentationConnector.ServerToClientCallbacks.Reverse.call(Client.PresentationConnector.Callers.Client,parseInt(r.get("S")));break;case"over":Client.PresentationConnector.ServerToClientCallbacks.GameOver.call(Client.PresentationConnector.Callers.Client,r.get("W"))}}}export function SendMessage(e){"con"===Client.serverStatus&&Client.serverWebsocket.send(e)}export function OnlineSessionStart(e,t,n,r,o){Client.OnlineGameStart(e,t,n,r,o)}export function SendMove(e,t){SendMessage("MI"+e.toString()+"?S"+("bottom"===t?"B":"T")+"?")}